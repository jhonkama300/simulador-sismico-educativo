<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simulador S√≠smico Educativo - Aisladores de Base</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #333;
            padding: 20px;
            min-height: 100vh;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        .content {
            padding: 30px;
        }

        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
            border-bottom: 2px solid #e0e0e0;
            flex-wrap: wrap;
        }

        .tab {
            padding: 15px 25px;
            background: #f5f5f5;
            border: none;
            border-radius: 10px 10px 0 0;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            transition: all 0.3s;
            color: #555;
        }

        .tab:hover {
            background: #e0e0e0;
        }

        .tab.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            transform: translateY(-2px);
        }

        .panel {
            display: none;
            animation: fadeIn 0.3s;
        }

        .panel.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .control-section {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 15px;
            margin-bottom: 25px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        .control-section h3 {
            color: #2c3e50;
            margin-bottom: 20px;
            font-size: 1.4rem;
            border-bottom: 3px solid #667eea;
            padding-bottom: 10px;
        }

        .control-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
        }

        .control-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .control-group label {
            font-weight: 600;
            color: #555;
            font-size: 0.95rem;
        }

        .control-group input[type="range"] {
            width: 100%;
            height: 8px;
            border-radius: 5px;
            background: #ddd;
            outline: none;
            -webkit-appearance: none;
        }

        .control-group input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #667eea;
            cursor: pointer;
            transition: all 0.3s;
        }

        .control-group input[type="range"]::-webkit-slider-thumb:hover {
            transform: scale(1.2);
            background: #764ba2;
        }

        .value-display {
            font-size: 1.1rem;
            color: #667eea;
            font-weight: bold;
        }

        .building-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-top: 30px;
        }

        .building-card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 8px 16px rgba(0,0,0,0.1);
            border: 3px solid #e0e0e0;
        }

        .building-card.with-isolation {
            border-color: #4CAF50;
        }

        .building-card h4 {
            text-align: center;
            margin-bottom: 20px;
            font-size: 1.3rem;
            color: #2c3e50;
        }

        .building-visual {
            position: relative;
            height: 400px;
            background: linear-gradient(to bottom, #e3f2fd 0%, #90caf9 100%);
            border-radius: 10px;
            overflow: hidden;
            margin-bottom: 20px;
        }

        .ground {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 80px;
            background: linear-gradient(to bottom, #8d6e63 0%, #5d4037 100%);
            border-top: 3px solid #6d4c41;
        }

        .isolator {
            position: absolute;
            bottom: 80px;
            left: 50%;
            transform: translateX(-50%);
            width: 120px;
            height: 30px;
            background: repeating-linear-gradient(
                45deg,
                #FFC107,
                #FFC107 10px,
                #FF9800 10px,
                #FF9800 20px
            );
            border: 2px solid #F57C00;
            border-radius: 5px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem;
            font-weight: bold;
            color: #fff;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.5);
        }

        .building {
            position: absolute;
            bottom: 110px;
            left: 50%;
            transform: translateX(-50%);
            width: 100px;
            transition: transform 0.05s;
        }

        .building.no-isolation {
            bottom: 80px;
        }

        .floor {
            width: 100%;
            height: 40px;
            background: linear-gradient(to right, #546e7a 0%, #37474f 100%);
            border: 2px solid #263238;
            border-bottom: none;
            position: relative;
        }

        .floor:last-child {
            border-radius: 5px 5px 0 0;
            border-bottom: 2px solid #263238;
        }

        .floor::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 10%;
            right: 10%;
            height: 60%;
            background: rgba(255, 255, 255, 0.1);
            transform: translateY(-50%);
        }

        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .metric-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }

        .metric-card.success {
            background: linear-gradient(135deg, #4CAF50 0%, #45a049 100%);
        }

        .metric-card.danger {
            background: linear-gradient(135deg, #f44336 0%, #d32f2f 100%);
        }

        .metric-label {
            font-size: 0.85rem;
            opacity: 0.9;
            margin-bottom: 5px;
        }

        .metric-value {
            font-size: 1.5rem;
            font-weight: bold;
        }

        .metric-unit {
            font-size: 0.9rem;
            opacity: 0.8;
        }

        .comparison-section {
            margin-top: 30px;
            padding: 25px;
            background: #f8f9fa;
            border-radius: 15px;
        }

        .comparison-section h4 {
            color: #2c3e50;
            margin-bottom: 20px;
            font-size: 1.3rem;
        }

        .comparison-bars {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .comparison-item {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .comparison-label {
            font-weight: 600;
            color: #555;
        }

        .bars-container {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .bar {
            height: 30px;
            border-radius: 5px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 0.85rem;
            transition: width 0.5s;
            min-width: 60px;
        }

        .bar.without {
            background: linear-gradient(90deg, #f44336 0%, #d32f2f 100%);
        }

        .bar.with {
            background: linear-gradient(90deg, #4CAF50 0%, #45a049 100%);
        }

        .chart-container {
            position: relative;
            height: 300px;
            margin: 20px 0;
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }

        .charts-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 30px;
            margin-top: 30px;
        }

        .btn-simulate {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 18px 40px;
            border-radius: 50px;
            font-size: 1.2rem;
            font-weight: bold;
            cursor: pointer;
            display: block;
            margin: 30px auto;
            box-shadow: 0 8px 16px rgba(0,0,0,0.2);
            transition: all 0.3s;
        }

        .btn-simulate:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 24px rgba(0,0,0,0.3);
        }

        .btn-simulate:active {
            transform: translateY(-1px);
        }

        .btn-simulate:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        .info-box {
            background: #e3f2fd;
            padding: 15px;
            border-radius: 10px;
            margin: 15px 0;
            border-left: 4px solid #2196F3;
        }

        .info-box h5 {
            margin-bottom: 10px;
            color: #1976D2;
        }

        .info-box p {
            margin: 5px 0;
            font-size: 0.95rem;
            line-height: 1.5;
        }

        @media (max-width: 768px) {
            .building-container {
                grid-template-columns: 1fr;
            }
            
            .control-grid {
                grid-template-columns: 1fr;
            }
            
            .header h1 {
                font-size: 1.8rem;
            }
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // Constantes f√≠sicas
        const G = 9.81; // m/s¬≤
        const PI = Math.PI;

        // Funciones de c√°lculo basadas en la teor√≠a real de aisladores s√≠smicos
        
        function calcularPeriodo(numPisos) {
            return 0.1 * numPisos; // T = 0.1 * N (segundos) - F√≥rmula simplificada
        }

        function calcularFrecuencia(periodo) {
            return 1 / periodo; // f = 1/T (Hz)
        }

        function calcularFrecuenciaAngular(periodo) {
            return (2 * PI) / periodo; // œâ = 2œÄ/T (rad/s)
        }

        function calcularPGA(magnitud, distancia, factorSuelo) {
            // F√≥rmula de atenuaci√≥n simplificada
            const energia = Math.pow(10, 1.5 * magnitud + 4.8);
            const factorAtenuacion = 1 / Math.pow(distancia, 1.5);
            const intensidad = Math.log10(energia * factorAtenuacion) / 1.5;
            return intensidad * factorSuelo;
        }

        function calcularFrecuenciaSitio(velocidadCorte, espesorCapa) {
            return velocidadCorte / (4 * espesorCapa); // f‚ÇÄ ‚âà VS/(4H) (Hz)
        }

        function calcularPeriodoAislado(masa, rigidezEfectiva) {
            return 2 * PI * Math.sqrt(masa / rigidezEfectiva); // Tiso = 2œÄ‚àö(m/k_eff)
        }

        function calcularAmortiguamientoEfectivo(tipoAislador, desplazamiento) {
            // Seg√∫n el documento: LRB proporciona 25-30% de amortiguamiento
            // HDRB proporciona 10-20% de amortiguamiento
            // FPS depende del coeficiente de fricci√≥n
            switch(tipoAislador) {
                case 'LRB':
                    return 0.27; // 27% amortiguamiento efectivo
                case 'HDRB':
                    return 0.15; // 15% amortiguamiento efectivo
                case 'FPS':
                    return 0.20; // 20% amortiguamiento por fricci√≥n
                default:
                    return 0.05;
            }
        }

        function calcularEnergiasCinetica(masa, velocidad) {
            return 0.5 * masa * Math.pow(velocidad, 2); // Ek = ¬Ωmv¬≤
        }

        function calcularEnergiaPotencial(rigidez, desplazamiento) {
            return 0.5 * rigidez * Math.pow(desplazamiento, 2); // Es = ¬Ωku¬≤
        }

        function calcularCortanteBasal(rigidez, desplazamiento, amortiguamiento, velocidad) {
            return rigidez * desplazamiento + amortiguamiento * velocidad; // V = ku + cv
        }

        function SimuladorSismico() {
            const [activeTab, setActiveTab] = useState('configuracion');
            const [isSimulating, setIsSimulating] = useState(false);
            
            // Par√°metros de la fuente s√≠smica
            const [magnitud, setMagnitud] = useState(6.5);
            const [distanciaEpicentral, setDistanciaEpicentral] = useState(50);
            
            // Par√°metros del sitio
            const [tipoSuelo, setTipoSuelo] = useState('suelo_denso');
            const [velocidadCorte, setVelocidadCorte] = useState(270);
            const [espesorCapa, setEspesorCapa] = useState(30);
            
            // Par√°metros de la estructura
            const [numPisos, setNumPisos] = useState(5);
            const [masaPorPiso, setMasaPorPiso] = useState(50000);
            const [amortiguamiento, setAmortiguamiento] = useState(0.05);
            
            // Par√°metros del aislador
            const [tieneAislador, setTieneAislador] = useState(true);
            const [tipoAislador, setTipoAislador] = useState('LRB');
            const [rigidezAislador, setRigidezAislador] = useState(500000);
            
            // Resultados de la simulaci√≥n
            const [resultados, setResultados] = useState(null);
            const [desplazamientoSin, setDesplazamientoSin] = useState(0);
            const [desplazamientoCon, setDesplazamientoCon] = useState(0);
            
            // Referencias para las gr√°ficas
            const chartDesplazamientoRef = useRef(null);
            const chartAceleracionRef = useRef(null);
            const chartEnergiaRef = useRef(null);
            
            const chartDesplazamientoInstance = useRef(null);
            const chartAceleracionInstance = useRef(null);
            const chartEnergiaInstance = useRef(null);

            // Valores calculados - Factor de suelo seg√∫n NSR-10 Colombia
            const obtenerFactorSuelo = () => {
                switch(tipoSuelo) {
                    case 'roca': return 1.0;
                    case 'roca_suave': return 1.2;
                    case 'suelo_denso': return 1.5;
                    case 'suelo_rigido': return 1.8;
                    case 'suelo_blando': return 2.4;
                    default: return 1.0;
                }
            };
            
            const factorSuelo = obtenerFactorSuelo();
            const masaTotal = numPisos * masaPorPiso;
            const periodo = calcularPeriodo(numPisos);
            const frecuencia = calcularFrecuencia(periodo);
            const frecuenciaAngular = calcularFrecuenciaAngular(periodo);
            const frecuenciaSitio = calcularFrecuenciaSitio(velocidadCorte, espesorCapa);

            const simular = () => {
                setIsSimulating(true);
                setActiveTab('graficas');
                
                // Calcular PGA
                const pga = calcularPGA(magnitud, distanciaEpicentral, factorSuelo);
                
                // Calcular rigidez y amortiguamiento estructural
                const rigidez = masaTotal * Math.pow(frecuenciaAngular, 2);
                const coefAmortiguamiento = 2 * amortiguamiento * masaTotal * frecuenciaAngular;
                
                // Factor de amplificaci√≥n din√°mica (t√≠picamente 2.5 para estructuras sin aislar)
                const factorAmplificacion = 2.5;
                
                // Sin aislador - Base Fija
                const desplMaxSin = (pga / Math.pow(frecuenciaAngular, 2)) * factorAmplificacion;
                const velMaxSin = desplMaxSin * frecuenciaAngular;
                const acelMaxSin = pga * factorAmplificacion;
                
                // Energ√≠as sin aislador
                const energiaCineticaSin = calcularEnergiasCinetica(masaTotal, velMaxSin);
                const energiaPotencialSin = calcularEnergiaPotencial(rigidez, desplMaxSin);
                const energiaMecanicaSin = energiaCineticaSin + energiaPotencialSin;
                const cortanteBasalSin = calcularCortanteBasal(rigidez, desplMaxSin, coefAmortiguamiento, velMaxSin);
                
                // Con aislador - seg√∫n tipo
                let desplMaxCon, velMaxCon, acelMaxCon, energiaCineticaCon, energiaPotencialCon;
                let energiaMecanicaCon, cortanteBasalCon, periodoAislado, amortiguamientoEfectivo;
                
                if (tieneAislador) {
                    periodoAislado = calcularPeriodoAislado(masaTotal, rigidezAislador);
                    const frecuenciaAngularAislada = 2 * PI / periodoAislado;
                    
                    // Amortiguamiento efectivo seg√∫n tipo de aislador
                    amortiguamientoEfectivo = calcularAmortiguamientoEfectivo(tipoAislador, 0);
                    
                    // Factores de reducci√≥n seg√∫n documento t√©cnico
                    // LRB: Reducci√≥n t√≠pica 60-80%
                    // HDRB: Reducci√≥n t√≠pica 50-70%
                    // FPS: Reducci√≥n t√≠pica 55-75%
                    let factorReduccion;
                    switch(tipoAislador) {
                        case 'LRB':
                            factorReduccion = 0.25; // Reduce a 25% (75% de reducci√≥n)
                            break;
                        case 'HDRB':
                            factorReduccion = 0.35; // Reduce a 35% (65% de reducci√≥n)
                            break;
                        case 'FPS':
                            factorReduccion = 0.30; // Reduce a 30% (70% de reducci√≥n)
                            break;
                        default:
                            factorReduccion = 0.3;
                    }
                    
                    acelMaxCon = pga * factorReduccion;
                    desplMaxCon = (acelMaxCon / Math.pow(frecuenciaAngularAislada, 2)) * 1.5;
                    velMaxCon = desplMaxCon * frecuenciaAngularAislada;
                    
                    const coefAmortiguamientoEfectivo = 2 * amortiguamientoEfectivo * masaTotal * frecuenciaAngularAislada;
                    
                    energiaCineticaCon = calcularEnergiasCinetica(masaTotal, velMaxCon);
                    energiaPotencialCon = calcularEnergiaPotencial(rigidezAislador, desplMaxCon);
                    energiaMecanicaCon = energiaCineticaCon + energiaPotencialCon;
                    cortanteBasalCon = calcularCortanteBasal(
                        rigidezAislador, 
                        desplMaxCon, 
                        coefAmortiguamientoEfectivo, 
                        velMaxCon
                    );
                } else {
                    desplMaxCon = desplMaxSin;
                    velMaxCon = velMaxSin;
                    acelMaxCon = acelMaxSin;
                    energiaCineticaCon = energiaCineticaSin;
                    energiaPotencialCon = energiaPotencialSin;
                    energiaMecanicaCon = energiaMecanicaSin;
                    cortanteBasalCon = cortanteBasalSin;
                    periodoAislado = periodo;
                    amortiguamientoEfectivo = amortiguamiento;
                }
                
                // Factores de reducci√≥n
                const reduccionCortante = tieneAislador ? 
                    (1 - cortanteBasalCon / cortanteBasalSin) * 100 : 0;
                const reduccionAceleracion = tieneAislador ? 
                    (1 - acelMaxCon / acelMaxSin) * 100 : 0;
                
                setResultados({
                    sinAislador: {
                        desplazamiento: desplMaxSin,
                        velocidad: velMaxSin,
                        aceleracion: acelMaxSin,
                        energiaCinetica: energiaCineticaSin,
                        energiaPotencial: energiaPotencialSin,
                        energiaMecanica: energiaMecanicaSin,
                        cortanteBasal: cortanteBasalSin,
                        fuerzaSismica: masaTotal * acelMaxSin
                    },
                    conAislador: {
                        desplazamiento: desplMaxCon,
                        velocidad: velMaxCon,
                        aceleracion: acelMaxCon,
                        energiaCinetica: energiaCineticaCon,
                        energiaPotencial: energiaPotencialCon,
                        energiaMecanica: energiaMecanicaCon,
                        cortanteBasal: cortanteBasalCon,
                        fuerzaSismica: masaTotal * acelMaxCon,
                        periodoAislado: periodoAislado,
                        amortiguamientoEfectivo: amortiguamientoEfectivo
                    },
                    metricas: {
                        pga: pga,
                        frecuenciaSitio: frecuenciaSitio
                    },
                    reduccion: {
                        cortante: reduccionCortante,
                        aceleracion: reduccionAceleracion
                    },
                    parametros: {
                        duracion: 20,
                        dt: 0.02,
                        desplMaxSin,
                        desplMaxCon,
                        acelMaxSin,
                        acelMaxCon,
                        frecuenciaAngular,
                        frecuenciaAngularAislada: tieneAislador ? 2 * PI / periodoAislado : frecuenciaAngular,
                        amortiguamiento,
                        amortiguamientoEfectivo: tieneAislador ? amortiguamientoEfectivo : amortiguamiento,
                        energiaMecanicaSin,
                        energiaMecanicaCon
                    }
                });
                
                // Iniciar animaci√≥n de gr√°ficas
                setTimeout(() => {
                    animarGraficas(20, 0.02, {
                        desplMaxSin,
                        desplMaxCon,
                        acelMaxSin,
                        acelMaxCon,
                        frecuenciaAngular,
                        frecuenciaAngularAislada: tieneAislador ? 2 * PI / periodoAislado : frecuenciaAngular,
                        amortiguamiento,
                        amortiguamientoEfectivo: tieneAislador ? amortiguamientoEfectivo : amortiguamiento,
                        energiaMecanicaSin,
                        energiaMecanicaCon
                    });
                }, 100);
            };

            const animarGraficas = (duracion, dt, params) => {
                const numPuntos = Math.floor(duracion / dt);
                let currentIndex = 0;
                
                const tiempos = [];
                const desplazamientosSin = [];
                const desplazamientosCon = [];
                const aceleracionesSin = [];
                const aceleracionesCon = [];
                const energiasSin = [];
                const energiasCon = [];
                
                const intervalo = setInterval(() => {
                    if (currentIndex >= numPuntos) {
                        clearInterval(intervalo);
                        setIsSimulating(false);
                        return;
                    }
                    
                    const t = currentIndex * dt;
                    const envolvente = Math.exp(-0.1 * t);
                    
                    // Desplazamientos
                    const desplSin = params.desplMaxSin * Math.sin(params.frecuenciaAngular * t) * 
                                     Math.exp(-params.amortiguamiento * params.frecuenciaAngular * t) * envolvente;
                    const desplCon = params.desplMaxCon * Math.sin(params.frecuenciaAngularAislada * t) * 
                                     Math.exp(-params.amortiguamientoEfectivo * params.frecuenciaAngularAislada * t) * envolvente;
                    
                    // Aceleraciones
                    const acelSin = params.acelMaxSin * Math.sin(params.frecuenciaAngular * t) * envolvente;
                    const acelCon = params.acelMaxCon * Math.sin(params.frecuenciaAngularAislada * t) * envolvente;
                    
                    // Energ√≠as
                    const energiaSin = params.energiaMecanicaSin * Math.pow(Math.cos(params.frecuenciaAngular * t), 2) * 
                                       Math.exp(-0.1 * t);
                    const energiaCon = params.energiaMecanicaCon * Math.pow(Math.cos(params.frecuenciaAngularAislada * t), 2) * 
                                       Math.exp(-0.1 * t);
                    
                    tiempos.push(t.toFixed(2));
                    desplazamientosSin.push((desplSin * 100).toFixed(2));
                    desplazamientosCon.push((desplCon * 100).toFixed(2));
                    aceleracionesSin.push(acelSin.toFixed(2));
                    aceleracionesCon.push(acelCon.toFixed(2));
                    energiasSin.push((energiaSin / 1000).toFixed(2));
                    energiasCon.push((energiaCon / 1000).toFixed(2));
                    
                    // Actualizar visualizaci√≥n de edificios
                    setDesplazamientoSin(desplSin * 100);
                    setDesplazamientoCon(desplCon * 100);
                    
                    // Actualizar gr√°ficas
                    const startIndex = Math.max(0, currentIndex - 200);
                    
                    if (chartDesplazamientoInstance.current) {
                        chartDesplazamientoInstance.current.data.labels = tiempos.slice(startIndex);
                        chartDesplazamientoInstance.current.data.datasets[0].data = desplazamientosSin.slice(startIndex);
                        chartDesplazamientoInstance.current.data.datasets[1].data = desplazamientosCon.slice(startIndex);
                        chartDesplazamientoInstance.current.update('none');
                    }
                    
                    if (chartAceleracionInstance.current) {
                        chartAceleracionInstance.current.data.labels = tiempos.slice(startIndex);
                        chartAceleracionInstance.current.data.datasets[0].data = aceleracionesSin.slice(startIndex);
                        chartAceleracionInstance.current.data.datasets[1].data = aceleracionesCon.slice(startIndex);
                        chartAceleracionInstance.current.update('none');
                    }
                    
                    if (chartEnergiaInstance.current) {
                        chartEnergiaInstance.current.data.labels = tiempos.slice(startIndex);
                        chartEnergiaInstance.current.data.datasets[0].data = energiasSin.slice(startIndex);
                        chartEnergiaInstance.current.data.datasets[1].data = energiasCon.slice(startIndex);
                        chartEnergiaInstance.current.update('none');
                    }
                    
                    currentIndex++;
                }, 50);
            };

            // Inicializar gr√°ficas
            useEffect(() => {
                if (activeTab === 'graficas' && chartDesplazamientoRef.current && !chartDesplazamientoInstance.current) {
                    const ctxDespl = chartDesplazamientoRef.current.getContext('2d');
                    chartDesplazamientoInstance.current = new Chart(ctxDespl, {
                        type: 'line',
                        data: {
                            labels: [],
                            datasets: [
                                {
                                    label: 'Sin Aislador (Base Fija)',
                                    data: [],
                                    borderColor: '#f44336',
                                    backgroundColor: 'rgba(244, 67, 54, 0.1)',
                                    borderWidth: 2,
                                    tension: 0.4,
                                    pointRadius: 0
                                },
                                {
                                    label: `Con Aislador (${tipoAislador})`,
                                    data: [],
                                    borderColor: '#4CAF50',
                                    backgroundColor: 'rgba(76, 175, 80, 0.1)',
                                    borderWidth: 2,
                                    tension: 0.4,
                                    pointRadius: 0
                                }
                            ]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            animation: false,
                            plugins: {
                                legend: {
                                    display: true,
                                    position: 'top'
                                },
                                title: {
                                    display: true,
                                    text: 'Desplazamiento vs Tiempo',
                                    font: { size: 16, weight: 'bold' }
                                }
                            },
                            scales: {
                                x: {
                                    title: {
                                        display: true,
                                        text: 'Tiempo (s)'
                                    }
                                },
                                y: {
                                    title: {
                                        display: true,
                                        text: 'Desplazamiento (cm)'
                                    }
                                }
                            }
                        }
                    });
                }
                
                if (activeTab === 'graficas' && chartAceleracionRef.current && !chartAceleracionInstance.current) {
                    const ctxAcel = chartAceleracionRef.current.getContext('2d');
                    chartAceleracionInstance.current = new Chart(ctxAcel, {
                        type: 'line',
                        data: {
                            labels: [],
                            datasets: [
                                {
                                    label: 'Sin Aislador (Base Fija)',
                                    data: [],
                                    borderColor: '#f44336',
                                    backgroundColor: 'rgba(244, 67, 54, 0.1)',
                                    borderWidth: 2,
                                    tension: 0.4,
                                    pointRadius: 0
                                },
                                {
                                    label: `Con Aislador (${tipoAislador})`,
                                    data: [],
                                    borderColor: '#4CAF50',
                                    backgroundColor: 'rgba(76, 175, 80, 0.1)',
                                    borderWidth: 2,
                                    tension: 0.4,
                                    pointRadius: 0
                                }
                            ]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            animation: false,
                            plugins: {
                                legend: {
                                    display: true,
                                    position: 'top'
                                },
                                title: {
                                    display: true,
                                    text: 'Aceleraci√≥n vs Tiempo',
                                    font: { size: 16, weight: 'bold' }
                                }
                            },
                            scales: {
                                x: {
                                    title: {
                                        display: true,
                                        text: 'Tiempo (s)'
                                    }
                                },
                                y: {
                                    title: {
                                        display: true,
                                        text: 'Aceleraci√≥n (m/s¬≤)'
                                    }
                                }
                            }
                        }
                    });
                }
                
                if (activeTab === 'graficas' && chartEnergiaRef.current && !chartEnergiaInstance.current) {
                    const ctxEnergia = chartEnergiaRef.current.getContext('2d');
                    chartEnergiaInstance.current = new Chart(ctxEnergia, {
                        type: 'line',
                        data: {
                            labels: [],
                            datasets: [
                                {
                                    label: 'Sin Aislador (Base Fija)',
                                    data: [],
                                    borderColor: '#f44336',
                                    backgroundColor: 'rgba(244, 67, 54, 0.1)',
                                    borderWidth: 2,
                                    tension: 0.4,
                                    pointRadius: 0,
                                    fill: true
                                },
                                {
                                    label: `Con Aislador (${tipoAislador})`,
                                    data: [],
                                    borderColor: '#4CAF50',
                                    backgroundColor: 'rgba(76, 175, 80, 0.1)',
                                    borderWidth: 2,
                                    tension: 0.4,
                                    pointRadius: 0,
                                    fill: true
                                }
                            ]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            animation: false,
                            plugins: {
                                legend: {
                                    display: true,
                                    position: 'top'
                                },
                                title: {
                                    display: true,
                                    text: 'Energ√≠a Mec√°nica vs Tiempo',
                                    font: { size: 16, weight: 'bold' }
                                }
                            },
                            scales: {
                                x: {
                                    title: {
                                        display: true,
                                        text: 'Tiempo (s)'
                                    }
                                },
                                y: {
                                    title: {
                                        display: true,
                                        text: 'Energ√≠a (kJ)'
                                    }
                                }
                            }
                        }
                    });
                }
            }, [activeTab]);

            // Obtener informaci√≥n del tipo de aislador
            const getAisladorInfo = () => {
                switch(tipoAislador) {
                    case 'LRB':
                        return {
                            nombre: 'Lead Rubber Bearing (LRB)',
                            descripcion: 'Aislador elastom√©rico con n√∫cleo de plomo',
                            amortiguamiento: '25-30%',
                            caracteristicas: 'El n√∫cleo de plomo disipa energ√≠a mediante deformaci√≥n pl√°stica. Muy efectivo para sismos fuertes.'
                        };
                    case 'HDRB':
                        return {
                            nombre: 'High Damping Rubber Bearing (HDRB)',
                            descripcion: 'Aislador de goma de alto amortiguamiento',
                            amortiguamiento: '10-20%',
                            caracteristicas: 'Usa caucho especial con aditivos (carb√≥n, aceites, resinas) que aumentan el amortiguamiento.'
                        };
                    case 'FPS':
                        return {
                            nombre: 'Friction Pendulum System (FPS)',
                            descripcion: 'Sistema de p√©ndulo friccional',
                            amortiguamiento: '15-25%',
                            caracteristicas: 'Deslizamiento sobre superficie c√≥ncava. El amortiguamiento proviene de la fricci√≥n controlada.'
                        };
                    default:
                        return null;
                }
            };

            const aisladorInfo = getAisladorInfo();

            return (
                <div className="container">
                    <div className="header">
                        <h1>üåç Simulador S√≠smico Educativo</h1>
                        <p>Sistemas de Aislamiento S√≠smico de Base - Colombia</p>
                    </div>
                    
                    <div className="content">
                        <div className="tabs">
                            <button 
                                className={`tab ${activeTab === 'configuracion' ? 'active' : ''}`}
                                onClick={() => setActiveTab('configuracion')}
                            >
                                ‚öôÔ∏è Configuraci√≥n
                            </button>
                            <button 
                                className={`tab ${activeTab === 'ondas' ? 'active' : ''}`}
                                onClick={() => setActiveTab('ondas')}
                            >
                                üåä Ondas S√≠smicas
                            </button>
                            <button 
                                className={`tab ${activeTab === 'visualizacion' ? 'active' : ''}`}
                                onClick={() => setActiveTab('visualizacion')}
                            >
                                üè¢ Visualizaci√≥n
                            </button>
                            <button 
                                className={`tab ${activeTab === 'energia' ? 'active' : ''}`}
                                onClick={() => setActiveTab('energia')}
                            >
                                ‚ö° An√°lisis Energ√©tico
                            </button>
                            <button 
                                className={`tab ${activeTab === 'graficas' ? 'active' : ''}`}
                                onClick={() => setActiveTab('graficas')}
                            >
                                üìà Gr√°ficas Din√°micas
                            </button>
                            <button 
                                className={`tab ${activeTab === 'resultados' ? 'active' : ''}`}
                                onClick={() => setActiveTab('resultados')}
                            >
                                üìä Resultados
                            </button>
                            <button 
                                className={`tab ${activeTab === 'teoria' ? 'active' : ''}`}
                                onClick={() => setActiveTab('teoria')}
                            >
                                üìö Teor√≠a
                            </button>
                        </div>

                        {/* Panel de Ondas S√≠smicas */}
                        <div className={`panel ${activeTab === 'ondas' ? 'active' : ''}`}>
                            <div className="control-section">
                                <h3>üåä Propagaci√≥n de Ondas S√≠smicas en Diferentes Tipos de Suelo</h3>
                                <p style={{marginBottom: '20px', color: '#666'}}>
                                    Las ondas s√≠smicas se propagan de manera diferente seg√∫n el tipo de suelo. Los suelos blandos 
                                    amplifican m√°s las ondas que los suelos rocosos debido a su menor velocidad de corte y mayor deformabilidad.
                                </p>
                                
                                {/* Visualizaci√≥n comparativa de suelos */}
                                <div style={{
                                    display: 'grid',
                                    gridTemplateColumns: 'repeat(auto-fit, minmax(300px, 1fr))',
                                    gap: '20px',
                                    marginBottom: '30px'
                                }}>
                                    {[
                                        {tipo: 'roca', nombre: 'Roca (Tipo A)', vs: 800, factor: 1.0, color: '#78909c'},
                                        {tipo: 'roca_suave', nombre: 'Roca Suave (Tipo B)', vs: 550, factor: 1.2, color: '#90a4ae'},
                                        {tipo: 'suelo_denso', nombre: 'Suelo Denso (Tipo C)', vs: 270, factor: 1.5, color: '#a1887f'},
                                        {tipo: 'suelo_rigido', nombre: 'Suelo R√≠gido (Tipo D)', vs: 180, factor: 1.8, color: '#bcaaa4'},
                                        {tipo: 'suelo_blando', nombre: 'Suelo Blando (Tipo E)', vs: 120, factor: 2.4, color: '#d7ccc8'}
                                    ].map((suelo, idx) => (
                                        <div key={idx} style={{
                                            background: 'white',
                                            borderRadius: '15px',
                                            padding: '20px',
                                            border: tipoSuelo === suelo.tipo ? '3px solid #667eea' : '2px solid #e0e0e0',
                                            cursor: 'pointer',
                                            transition: 'all 0.3s',
                                            boxShadow: tipoSuelo === suelo.tipo ? '0 8px 16px rgba(102,126,234,0.3)' : '0 4px 8px rgba(0,0,0,0.1)'
                                        }}
                                        onClick={() => {
                                            setTipoSuelo(suelo.tipo);
                                            setVelocidadCorte(suelo.vs);
                                        }}>
                                            <h4 style={{marginBottom: '15px', color: '#2c3e50'}}>{suelo.nombre}</h4>
                                            <svg width="100%" height="100" viewBox="0 0 280 100">
                                                <rect x="0" y="0" width="280" height="100" fill={suelo.color} opacity="0.3"/>
                                                {/* Ondas con amplitud proporcional al factor */}
                                                {Array.from({length: 4}, (_, i) => {
                                                    const amplitude = suelo.factor * 10;
                                                    return (
                                                        <path
                                                            key={i}
                                                            d={`M ${i * 70} 50 Q ${i * 70 + 17.5} ${50 - amplitude}, ${i * 70 + 35} 50 T ${i * 70 + 70} 50`}
                                                            stroke="#ff5722"
                                                            strokeWidth="2.5"
                                                            fill="none"
                                                            opacity="0.8"
                                                        />
                                                    );
                                                })}
                                            </svg>
                                            <div style={{marginTop: '10px', fontSize: '0.9rem'}}>
                                                <div><strong>Vs:</strong> {suelo.vs} m/s</div>
                                                <div><strong>Factor amplificaci√≥n:</strong> {suelo.factor}x</div>
                                                <div style={{color: suelo.factor > 1.5 ? '#f44336' : '#4CAF50', fontWeight: 'bold'}}>
                                                    {suelo.factor > 1.5 ? '‚ö†Ô∏è Alta amplificaci√≥n' : '‚úì Baja amplificaci√≥n'}
                                                </div>
                                            </div>
                                        </div>
                                    ))}
                                </div>

                                {/* Informaci√≥n del suelo actual */}
                                <div className="info-box">
                                    <h5>üìç Suelo Seleccionado: {
                                        tipoSuelo === 'roca' ? 'Roca (Tipo A)' :
                                        tipoSuelo === 'roca_suave' ? 'Roca Suave (Tipo B)' :
                                        tipoSuelo === 'suelo_denso' ? 'Suelo Denso (Tipo C)' :
                                        tipoSuelo === 'suelo_rigido' ? 'Suelo R√≠gido (Tipo D)' :
                                        'Suelo Blando (Tipo E)'
                                    }</h5>
                                    <div style={{display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '10px', marginTop: '15px'}}>
                                        <div>
                                            <strong>Velocidad de onda de corte (Vs):</strong> {velocidadCorte} m/s
                                        </div>
                                        <div>
                                            <strong>Factor de amplificaci√≥n:</strong> {factorSuelo.toFixed(2)}x
                                        </div>
                                        <div>
                                            <strong>Constante de rigidez del suelo:</strong> {(factorSuelo * 1000).toFixed(0)} kN/m¬≥
                                        </div>
                                        <div>
                                            <strong>Frecuencia fundamental:</strong> {frecuenciaSitio.toFixed(2)} Hz
                                        </div>
                                    </div>
                                    <p style={{marginTop: '15px', fontSize: '0.9rem'}}>
                                        <strong>Impacto:</strong> {
                                            factorSuelo < 1.3 ? 'Suelo favorable para construcci√≥n sismorresistente. Baja amplificaci√≥n de ondas.' :
                                            factorSuelo < 1.6 ? 'Suelo con amplificaci√≥n moderada. Se requieren consideraciones especiales de dise√±o.' :
                                            factorSuelo < 2.0 ? 'Suelo con amplificaci√≥n significativa. Alto riesgo s√≠smico, requiere dise√±o especializado.' :
                                            'Suelo muy blando con alta amplificaci√≥n. Riesgo s√≠smico muy alto, puede requerir aislamiento s√≠smico.'
                                        }
                                    </p>
                                </div>

                                {/* Simulaci√≥n de propagaci√≥n de ondas */}
                                <div style={{marginTop: '30px'}}>
                                    <h4 style={{marginBottom: '15px'}}>üé¨ Visualizaci√≥n de Propagaci√≥n de Ondas</h4>
                                    <div style={{
                                        background: 'linear-gradient(to bottom, #e3f2fd 0%, #fff 100%)',
                                        padding: '30px',
                                        borderRadius: '15px'
                                    }}>
                                        <svg width="100%" height="250" viewBox="0 0 800 250">
                                            <defs>
                                                <pattern id="soil-pattern" patternUnits="userSpaceOnUse" width="20" height="20">
                                                    <rect width="20" height="20" fill={
                                                        tipoSuelo === 'roca' ? '#78909c' :
                                                        tipoSuelo === 'roca_suave' ? '#90a4ae' :
                                                        tipoSuelo === 'suelo_denso' ? '#a1887f' :
                                                        tipoSuelo === 'suelo_rigido' ? '#bcaaa4' :
                                                        '#d7ccc8'
                                                    }/>
                                                    <line x1="0" y1="10" x2="20" y2="10" stroke="#fff" strokeWidth="0.5" opacity="0.3"/>
                                                </pattern>
                                                <linearGradient id="wave-gradient" x1="0%" y1="0%" x2="100%" y2="0%">
                                                    <stop offset="0%" stopColor="#ff5722" stopOpacity="0"/>
                                                    <stop offset="50%" stopColor="#ff5722" stopOpacity="1"/>
                                                    <stop offset="100%" stopColor="#ff5722" stopOpacity="0"/>
                                                </linearGradient>
                                            </defs>
                                            
                                            {/* Capa de suelo */}
                                            <rect x="0" y="0" width="800" height="150" fill="url(#soil-pattern)" opacity="0.6"/>
                                            <text x="400" y="75" textAnchor="middle" fill="#2c3e50" fontSize="16" fontWeight="bold">
                                                Capa de Suelo - {tipoSuelo === 'roca' ? 'Roca Tipo A' :
                                                tipoSuelo === 'roca_suave' ? 'Roca Suave Tipo B' :
                                                tipoSuelo === 'suelo_denso' ? 'Suelo Denso Tipo C' :
                                                tipoSuelo === 'suelo_rigido' ? 'Suelo R√≠gido Tipo D' :
                                                'Suelo Blando Tipo E'}
                                            </text>
                                            
                                            {/* Roca base */}
                                            <rect x="0" y="150" width="800" height="100" fill="#546e7a"/>
                                            <text x="400" y="200" textAnchor="middle" fill="#fff" fontSize="14" fontWeight="bold">
                                                Roca Base (Bedrock)
                                            </text>
                                            
                                            {/* Epicentro */}
                                            <circle cx="100" cy="200" r="8" fill="#ff5722"/>
                                            <text x="100" y="230" textAnchor="middle" fill="#ff5722" fontSize="12" fontWeight="bold">
                                                Epicentro
                                            </text>
                                            
                                            {/* Ondas propag√°ndose */}
                                            {isSimulating && Array.from({length: 12}, (_, i) => {
                                                const time = Date.now() / 1000;
                                                const waveSpeed = velocidadCorte / 50;
                                                const x = 100 + (i * 60 + time * waveSpeed * 60) % 700;
                                                const amplitude = factorSuelo * 15;
                                                const y = x < 100 ? 200 : 75;
                                                
                                                return (
                                                    <g key={i}>
                                                        <circle 
                                                            cx={x} 
                                                            cy={y} 
                                                            r={3 + Math.sin(time * 5 + i) * 2} 
                                                            fill="#ff5722"
                                                            opacity={0.7}
                                                        />
                                                        {x > 100 && (
                                                            <path
                                                                d={`M ${x - 20} ${y} Q ${x - 10} ${y - amplitude}, ${x} ${y} T ${x + 20} ${y}`}
                                                                stroke="url(#wave-gradient)"
                                                                strokeWidth="2"
                                                                fill="none"
                                                                opacity="0.6"
                                                            />
                                                        )}
                                                    </g>
                                                );
                                            })}
                                        </svg>
                                    </div>
                                </div>
                            </div>
                            
                            <button 
                                className="btn-simulate" 
                                onClick={simular}
                                disabled={isSimulating}
                            >
                                {isSimulating ? 'üåä Ondas Propag√°ndose...' : '‚ñ∂Ô∏è SIMULAR PROPAGACI√ìN'}
                            </button>
                        </div>

                        {/* Panel de Configuraci√≥n */}
                        <div className={`panel ${activeTab === 'configuracion' ? 'active' : ''}`}>
                            <div className="control-section">
                                <h3>üåä Fuente S√≠smica</h3>
                                <div className="control-grid">
                                    <div className="control-group">
                                        <label>Magnitud (Mw): <span className="value-display">{magnitud.toFixed(1)}</span></label>
                                        <input 
                                            type="range" 
                                            min="4" 
                                            max="9" 
                                            step="0.1" 
                                            value={magnitud}
                                            onChange={(e) => setMagnitud(parseFloat(e.target.value))}
                                        />
                                    </div>
                                    <div className="control-group">
                                        <label>Distancia Epicentral (R): <span className="value-display">{distanciaEpicentral} km</span></label>
                                        <input 
                                            type="range" 
                                            min="10" 
                                            max="200" 
                                            step="10" 
                                            value={distanciaEpicentral}
                                            onChange={(e) => setDistanciaEpicentral(parseFloat(e.target.value))}
                                        />
                                    </div>
                                </div>
                            </div>

                            <div className="control-section">
                                <h3>üèîÔ∏è Caracter√≠sticas del Sitio</h3>
                                <div className="control-grid">
                                    <div className="control-group">
                                        <label>Tipo de Suelo:</label>
                                        <select 
                                            value={tipoSuelo}
                                            onChange={(e) => setTipoSuelo(e.target.value)}
                                            style={{padding: '8px', borderRadius: '5px', border: '2px solid #ddd'}}
                                        >
                                            <option value="roca">Roca - Tipo A (Vs &gt; 750 m/s)</option>
                                            <option value="roca_suave">Roca Suave - Tipo B (360-750 m/s)</option>
                                            <option value="suelo_denso">Suelo Denso - Tipo C (180-360 m/s)</option>
                                            <option value="suelo_rigido">Suelo R√≠gido - Tipo D (180 m/s)</option>
                                            <option value="suelo_blando">Suelo Blando - Tipo E (&lt; 180 m/s)</option>
                                        </select>
                                    </div>
                                    <div className="control-group">
                                        <label>Velocidad de Corte (Vs): <span className="value-display">{velocidadCorte} m/s</span></label>
                                        <input 
                                            type="range" 
                                            min="100" 
                                            max="800" 
                                            step="50" 
                                            value={velocidadCorte}
                                            onChange={(e) => setVelocidadCorte(parseFloat(e.target.value))}
                                        />
                                    </div>
                                    <div className="control-group">
                                        <label>Espesor de Capa (H): <span className="value-display">{espesorCapa} m</span></label>
                                        <input 
                                            type="range" 
                                            min="10" 
                                            max="100" 
                                            step="5" 
                                            value={espesorCapa}
                                            onChange={(e) => setEspesorCapa(parseFloat(e.target.value))}
                                        />
                                    </div>
                                </div>
                                <div className="info-box">
                                    <div><strong>Frecuencia Fundamental del Sitio (f‚ÇÄ):</strong> {frecuenciaSitio.toFixed(2)} Hz</div>
                                    <div><strong>Factor de Amplificaci√≥n del Suelo:</strong> {factorSuelo.toFixed(2)}</div>
                                    <div><strong>Constante de Rigidez del Suelo:</strong> {(factorSuelo * 1000).toFixed(0)} kN/m¬≥</div>
                                    <p style={{fontSize: '0.85rem', marginTop: '5px'}}>
                                        La frecuencia del sitio es crucial para identificar posibles resonancias con la estructura. 
                                        Los suelos blandos amplifican m√°s las ondas s√≠smicas.
                                    </p>
                                </div>
                            </div>

                            <div className="control-section">
                                <h3>üèóÔ∏è Estructura</h3>
                                <div className="control-grid">
                                    <div className="control-group">
                                        <label>N√∫mero de Pisos: <span className="value-display">{numPisos}</span></label>
                                        <input 
                                            type="range" 
                                            min="1" 
                                            max="20" 
                                            step="1" 
                                            value={numPisos}
                                            onChange={(e) => setNumPisos(parseInt(e.target.value))}
                                        />
                                    </div>
                                    <div className="control-group">
                                        <label>Masa por Piso: <span className="value-display">{(masaPorPiso/1000).toFixed(0)} ton</span></label>
                                        <input 
                                            type="range" 
                                            min="20000" 
                                            max="100000" 
                                            step="10000" 
                                            value={masaPorPiso}
                                            onChange={(e) => setMasaPorPiso(parseFloat(e.target.value))}
                                        />
                                    </div>
                                    <div className="control-group">
                                        <label>Amortiguamiento (Œ∂): <span className="value-display">{(amortiguamiento*100).toFixed(1)}%</span></label>
                                        <input 
                                            type="range" 
                                            min="0.01" 
                                            max="0.15" 
                                            step="0.01" 
                                            value={amortiguamiento}
                                            onChange={(e) => setAmortiguamiento(parseFloat(e.target.value))}
                                        />
                                    </div>
                                </div>
                                <div className="info-box">
                                    <div><strong>Masa Total:</strong> {(masaTotal/1000).toFixed(0)} toneladas</div>
                                    <div><strong>Periodo Natural (T):</strong> {periodo.toFixed(3)} s</div>
                                    <div><strong>Frecuencia (f):</strong> {frecuencia.toFixed(3)} Hz</div>
                                    <div><strong>Frecuencia Angular (œâ):</strong> {frecuenciaAngular.toFixed(3)} rad/s</div>
                                </div>
                            </div>

                            <div className="control-section">
                                <h3>üõ°Ô∏è Sistema de Aislamiento S√≠smico</h3>
                                <div className="control-group" style={{marginBottom: '20px'}}>
                                    <label style={{display: 'flex', alignItems: 'center', gap: '10px'}}>
                                        <input 
                                            type="checkbox" 
                                            checked={tieneAislador}
                                            onChange={(e) => setTieneAislador(e.target.checked)}
                                            style={{width: '20px', height: '20px'}}
                                        />
                                        <span>Habilitar Aislamiento S√≠smico de Base</span>
                                    </label>
                                </div>
                                
                                {tieneAislador && (
                                    <>
                                        <div className="control-grid">
                                            <div className="control-group">
                                                <label>Tipo de Aislador:</label>
                                                <select 
                                                    value={tipoAislador}
                                                    onChange={(e) => setTipoAislador(e.target.value)}
                                                    style={{padding: '8px', borderRadius: '5px', border: '2px solid #ddd'}}
                                                >
                                                    <option value="LRB">LRB - Lead Rubber Bearing</option>
                                                    <option value="HDRB">HDRB - High Damping Rubber</option>
                                                    <option value="FPS">FPS - Friction Pendulum</option>
                                                </select>
                                            </div>
                                            <div className="control-group">
                                                <label>Rigidez Efectiva (k_eff): <span className="value-display">{(rigidezAislador/1000).toFixed(0)} kN/m</span></label>
                                                <input 
                                                    type="range" 
                                                    min="100000" 
                                                    max="2000000" 
                                                    step="50000" 
                                                    value={rigidezAislador}
                                                    onChange={(e) => setRigidezAislador(parseFloat(e.target.value))}
                                                />
                                            </div>
                                        </div>
                                        
                                        {aisladorInfo && (
                                            <div className="info-box">
                                                <h5>{aisladorInfo.nombre}</h5>
                                                <p><strong>Descripci√≥n:</strong> {aisladorInfo.descripcion}</p>
                                                <p><strong>Amortiguamiento t√≠pico:</strong> {aisladorInfo.amortiguamiento}</p>
                                                <p><strong>Caracter√≠sticas:</strong> {aisladorInfo.caracteristicas}</p>
                                            </div>
                                        )}
                                    </>
                                )}
                            </div>

                            <button 
                                className="btn-simulate" 
                                onClick={simular}
                                disabled={isSimulating}
                            >
                                {isSimulating ? '‚ö° Simulando Evento S√≠smico...' : '‚ñ∂Ô∏è INICIAR SIMULACI√ìN'}
                            </button>
                        </div>

                        {/* Panel de Visualizaci√≥n */}
                        <div className={`panel ${activeTab === 'visualizacion' ? 'active' : ''}`}>
                            {/* Visualizaci√≥n de Propagaci√≥n de Ondas */}
                            <div className="control-section">
                                <h3>üåä Propagaci√≥n de Ondas S√≠smicas en el Suelo</h3>
                                <div style={{
                                    background: 'linear-gradient(to bottom, #e3f2fd 0%, #fff 100%)',
                                    padding: '30px',
                                    borderRadius: '15px',
                                    marginBottom: '20px'
                                }}>
                                    <svg width="100%" height="200" viewBox="0 0 800 200">
                                        {/* Capas del suelo */}
                                        <defs>
                                            <pattern id="roca" patternUnits="userSpaceOnUse" width="20" height="20">
                                                <rect width="20" height="20" fill="#78909c"/>
                                                <circle cx="5" cy="5" r="2" fill="#546e7a"/>
                                                <circle cx="15" cy="15" r="2" fill="#546e7a"/>
                                            </pattern>
                                            <pattern id="suelo" patternUnits="userSpaceOnUse" width="15" height="15">
                                                <rect width="15" height="15" fill="#a1887f"/>
                                                <line x1="0" y1="7" x2="15" y2="7" stroke="#8d6e63" strokeWidth="1"/>
                                            </pattern>
                                        </defs>
                                        
                                        {/* Suelo superficial */}
                                        <rect x="0" y="0" width="800" height="80" fill="url(#suelo)" opacity="0.8"/>
                                        <text x="400" y="40" textAnchor="middle" fill="#fff" fontSize="14" fontWeight="bold">
                                            Capa de Suelo (H = {espesorCapa}m, Vs = {velocidadCorte}m/s)
                                        </text>
                                        
                                        {/* Roca base */}
                                        <rect x="0" y="80" width="800" height="120" fill="url(#roca)"/>
                                        <text x="400" y="140" textAnchor="middle" fill="#fff" fontSize="14" fontWeight="bold">
                                            Roca Base
                                        </text>
                                        
                                        {/* Ondas s√≠smicas animadas */}
                                        {isSimulating && Array.from({length: 8}, (_, i) => {
                                            const offset = (Date.now() / 50) % 100;
                                            const x = (i * 100 + offset) % 800;
                                            const amplitude = factorSuelo * 15;
                                            return (
                                                <g key={i}>
                                                    <path
                                                        d={`M ${x} 140 Q ${x + 25} ${140 - amplitude}, ${x + 50} 140 T ${x + 100} 140`}
                                                        stroke="#ff5722"
                                                        strokeWidth="3"
                                                        fill="none"
                                                        opacity="0.7"
                                                    />
                                                    <circle cx={x} cy="140" r="4" fill="#ff5722"/>
                                                </g>
                                            );
                                        })}
                                        
                                        {/* Flechas de direcci√≥n */}
                                        <defs>
                                            <marker id="arrowhead" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
                                                <polygon points="0 0, 10 3, 0 6" fill="#ff5722"/>
                                            </marker>
                                        </defs>
                                        <line x1="100" y1="160" x2="180" y2="160" stroke="#ff5722" strokeWidth="2" markerEnd="url(#arrowhead)"/>
                                        <text x="140" y="185" textAnchor="middle" fill="#ff5722" fontSize="12" fontWeight="bold">
                                            Direcci√≥n de propagaci√≥n
                                        </text>
                                    </svg>
                                    
                                    <div style={{
                                        display: 'grid',
                                        gridTemplateColumns: 'repeat(auto-fit, minmax(200px, 1fr))',
                                        gap: '15px',
                                        marginTop: '20px'
                                    }}>
                                        <div className="metric-card">
                                            <div className="metric-label">Velocidad de Onda</div>
                                            <div className="metric-value">{velocidadCorte}</div>
                                            <div className="metric-unit">m/s</div>
                                        </div>
                                        <div className="metric-card">
                                            <div className="metric-label">Amplificaci√≥n</div>
                                            <div className="metric-value">{factorSuelo.toFixed(2)}x</div>
                                            <div className="metric-unit">Factor</div>
                                        </div>
                                        <div className="metric-card">
                                            <div className="metric-label">Tipo de Suelo</div>
                                            <div className="metric-value" style={{fontSize: '1rem'}}>
                                                {tipoSuelo === 'roca' && 'Tipo A'}
                                                {tipoSuelo === 'roca_suave' && 'Tipo B'}
                                                {tipoSuelo === 'suelo_denso' && 'Tipo C'}
                                                {tipoSuelo === 'suelo_rigido' && 'Tipo D'}
                                                {tipoSuelo === 'suelo_blando' && 'Tipo E'}
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div className="building-container">
                                <div className="building-card">
                                    <h4>üè¢ Estructura con Base Fija</h4>
                                    <div className="building-visual">
                                        <div className="ground"></div>
                                        <div 
                                            className="building no-isolation" 
                                            style={{
                                                transform: `translateX(calc(-50% + ${desplazamientoSin}px))`
                                            }}
                                        >
                                            {Array.from({length: numPisos}, (_, i) => (
                                                <div key={i} className="floor"></div>
                                            ))}
                                        </div>
                                    </div>
                                    {resultados && (
                                        <>
                                        <div className="metrics-grid">
                                            <div className="metric-card danger">
                                                <div className="metric-label">Desplazamiento</div>
                                                <div className="metric-value">{(resultados.sinAislador.desplazamiento * 100).toFixed(2)}</div>
                                                <div className="metric-unit">cm</div>
                                            </div>
                                            <div className="metric-card danger">
                                                <div className="metric-label">Aceleraci√≥n</div>
                                                <div className="metric-value">{resultados.sinAislador.aceleracion.toFixed(2)}</div>
                                                <div className="metric-unit">m/s¬≤</div>
                                            </div>
                                            <div className="metric-card danger">
                                                <div className="metric-label">Cortante Basal</div>
                                                <div className="metric-value">{(resultados.sinAislador.cortanteBasal / 1000).toFixed(0)}</div>
                                                <div className="metric-unit">kN</div>
                                            </div>
                                        </div>
                                        
                                        {/* Medidores de Energ√≠a */}
                                        <div style={{marginTop: '20px'}}>
                                            <h4 style={{textAlign: 'center', marginBottom: '15px', color: '#2c3e50'}}>
                                                ‚ö° An√°lisis Energ√©tico
                                            </h4>
                                            <div className="metrics-grid">
                                                <div className="metric-card" style={{background: 'linear-gradient(135deg, #FF6B6B 0%, #C92A2A 100%)'}}>
                                                    <div className="metric-label">Energ√≠a Cin√©tica (Ek)</div>
                                                    <div className="metric-value">{(resultados.sinAislador.energiaCinetica / 1000).toFixed(1)}</div>
                                                    <div className="metric-unit">kJ</div>
                                                    <div style={{fontSize: '0.75rem', marginTop: '5px', opacity: 0.9}}>
                                                        Ek = ¬Ωmv¬≤
                                                    </div>
                                                </div>
                                                <div className="metric-card" style={{background: 'linear-gradient(135deg, #4ECDC4 0%, #44A08D 100%)'}}>
                                                    <div className="metric-label">Energ√≠a Potencial (Es)</div>
                                                    <div className="metric-value">{(resultados.sinAislador.energiaPotencial / 1000).toFixed(1)}</div>
                                                    <div className="metric-unit">kJ</div>
                                                    <div style={{fontSize: '0.75rem', marginTop: '5px', opacity: 0.9}}>
                                                        Es = ¬Ωku¬≤
                                                    </div>
                                                </div>
                                                <div className="metric-card" style={{background: 'linear-gradient(135deg, #F093FB 0%, #F5576C 100%)'}}>
                                                    <div className="metric-label">Energ√≠a Mec√°nica (Em)</div>
                                                    <div className="metric-value">{(resultados.sinAislador.energiaMecanica / 1000).toFixed(1)}</div>
                                                    <div className="metric-unit">kJ</div>
                                                    <div style={{fontSize: '0.75rem', marginTop: '5px', opacity: 0.9}}>
                                                        Em = Ek + Es
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        </>
                                    )}
                                </div>

                                <div className="building-card with-isolation">
                                    <h4>üõ°Ô∏è Estructura con Aislamiento S√≠smico</h4>
                                    <div className="building-visual">
                                        <div className="ground"></div>
                                        {tieneAislador && (
                                            <div className="isolator">
                                                {tipoAislador}
                                            </div>
                                        )}
                                        <div 
                                            className="building" 
                                            style={{
                                                transform: `translateX(calc(-50% + ${desplazamientoCon}px))`,
                                                bottom: tieneAislador ? '110px' : '80px'
                                            }}
                                        >
                                            {Array.from({length: numPisos}, (_, i) => (
                                                <div key={i} className="floor"></div>
                                            ))}
                                        </div>
                                    </div>
                                    {resultados && (
                                        <>
                                        <div className="metrics-grid">
                                            <div className="metric-card success">
                                                <div className="metric-label">Desplazamiento</div>
                                                <div className="metric-value">{(resultados.conAislador.desplazamiento * 100).toFixed(2)}</div>
                                                <div className="metric-unit">cm</div>
                                            </div>
                                            <div className="metric-card success">
                                                <div className="metric-label">Aceleraci√≥n</div>
                                                <div className="metric-value">{resultados.conAislador.aceleracion.toFixed(2)}</div>
                                                <div className="metric-unit">m/s¬≤</div>
                                            </div>
                                            <div className="metric-card success">
                                                <div className="metric-label">Cortante Basal</div>
                                                <div className="metric-value">{(resultados.conAislador.cortanteBasal / 1000).toFixed(0)}</div>
                                                <div className="metric-unit">kN</div>
                                            </div>
                                        </div>
                                        
                                        {/* Medidores de Energ√≠a */}
                                        <div style={{marginTop: '20px'}}>
                                            <h4 style={{textAlign: 'center', marginBottom: '15px', color: '#2c3e50'}}>
                                                ‚ö° An√°lisis Energ√©tico
                                            </h4>
                                            <div className="metrics-grid">
                                                <div className="metric-card success" style={{background: 'linear-gradient(135deg, #51CF66 0%, #37B24D 100%)'}}>
                                                    <div className="metric-label">Energ√≠a Cin√©tica (Ek)</div>
                                                    <div className="metric-value">{(resultados.conAislador.energiaCinetica / 1000).toFixed(1)}</div>
                                                    <div className="metric-unit">kJ</div>
                                                    <div style={{fontSize: '0.75rem', marginTop: '5px', opacity: 0.9}}>
                                                        ‚Üì {((1 - resultados.conAislador.energiaCinetica / resultados.sinAislador.energiaCinetica) * 100).toFixed(1)}% reducci√≥n
                                                    </div>
                                                </div>
                                                <div className="metric-card success" style={{background: 'linear-gradient(135deg, #20C997 0%, #12B886 100%)'}}>
                                                    <div className="metric-label">Energ√≠a Potencial (Es)</div>
                                                    <div className="metric-value">{(resultados.conAislador.energiaPotencial / 1000).toFixed(1)}</div>
                                                    <div className="metric-unit">kJ</div>
                                                    <div style={{fontSize: '0.75rem', marginTop: '5px', opacity: 0.9}}>
                                                        ‚Üì {((1 - resultados.conAislador.energiaPotencial / resultados.sinAislador.energiaPotencial) * 100).toFixed(1)}% reducci√≥n
                                                    </div>
                                                </div>
                                                <div className="metric-card success" style={{background: 'linear-gradient(135deg, #15AABF 0%, #0C8599 100%)'}}>
                                                    <div className="metric-label">Energ√≠a Mec√°nica (Em)</div>
                                                    <div className="metric-value">{(resultados.conAislador.energiaMecanica / 1000).toFixed(1)}</div>
                                                    <div className="metric-unit">kJ</div>
                                                    <div style={{fontSize: '0.75rem', marginTop: '5px', opacity: 0.9}}>
                                                        ‚Üì {((1 - resultados.conAislador.energiaMecanica / resultados.sinAislador.energiaMecanica) * 100).toFixed(1)}% reducci√≥n
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        </>
                                    )}
                                </div>
                            </div>
                        </div>

                        {/* Panel de An√°lisis Energ√©tico */}
                        <div className={`panel ${activeTab === 'energia' ? 'active' : ''}`}>
                            {resultados ? (
                                <div>
                                    <div className="control-section">
                                        <h3>‚ö° An√°lisis Energ√©tico Detallado del Sistema</h3>
                                        <p style={{marginBottom: '20px', color: '#666'}}>
                                            El an√°lisis energ√©tico permite comprender c√≥mo el aislador s√≠smico disipa y controla 
                                            la energ√≠a transmitida durante un evento s√≠smico.
                                        </p>

                                        {/* Comparaci√≥n energ√©tica lado a lado */}
                                        <div style={{
                                            display: 'grid',
                                            gridTemplateColumns: '1fr 1fr',
                                            gap: '30px',
                                            marginBottom: '30px'
                                        }}>
                                            {/* Sin aislador */}
                                            <div style={{
                                                background: 'linear-gradient(135deg, #ffebee 0%, #ffcdd2 100%)',
                                                padding: '25px',
                                                borderRadius: '15px',
                                                border: '3px solid #f44336'
                                            }}>
                                                <h4 style={{textAlign: 'center', color: '#c62828', marginBottom: '20px'}}>
                                                    üè¢ Base Fija (Sin Aislador)
                                                </h4>
                                                
                                                <div style={{marginBottom: '20px'}}>
                                                    <div style={{fontSize: '0.9rem', marginBottom: '8px', fontWeight: 'bold'}}>
                                                        Energ√≠a Cin√©tica (Ek = ¬Ωmv¬≤)
                                                    </div>
                                                    <div style={{
                                                        background: '#fff',
                                                        borderRadius: '10px',
                                                        padding: '15px',
                                                        boxShadow: '0 4px 8px rgba(0,0,0,0.1)'
                                                    }}>
                                                        <div style={{fontSize: '2rem', fontWeight: 'bold', color: '#f44336'}}>
                                                            {(resultados.sinAislador.energiaCinetica / 1000).toFixed(2)} kJ
                                                        </div>
                                                        <div style={{fontSize: '0.85rem', color: '#666', marginTop: '5px'}}>
                                                            Velocidad m√°x: {resultados.sinAislador.velocidad.toFixed(3)} m/s
                                                        </div>
                                                    </div>
                                                </div>

                                                <div style={{marginBottom: '20px'}}>
                                                    <div style={{fontSize: '0.9rem', marginBottom: '8px', fontWeight: 'bold'}}>
                                                        Energ√≠a Potencial El√°stica (Es = ¬Ωku¬≤)
                                                    </div>
                                                    <div style={{
                                                        background: '#fff',
                                                        borderRadius: '10px',
                                                        padding: '15px',
                                                        boxShadow: '0 4px 8px rgba(0,0,0,0.1)'
                                                    }}>
                                                        <div style={{fontSize: '2rem', fontWeight: 'bold', color: '#ff7043'}}>
                                                            {(resultados.sinAislador.energiaPotencial / 1000).toFixed(2)} kJ
                                                        </div>
                                                        <div style={{fontSize: '0.85rem', color: '#666', marginTop: '5px'}}>
                                                            Desplazamiento: {(resultados.sinAislador.desplazamiento * 100).toFixed(2)} cm
                                                        </div>
                                                    </div>
                                                </div>

                                                <div>
                                                    <div style={{fontSize: '0.9rem', marginBottom: '8px', fontWeight: 'bold'}}>
                                                        Energ√≠a Mec√°nica Total (Em = Ek + Es)
                                                    </div>
                                                    <div style={{
                                                        background: 'linear-gradient(135deg, #f44336 0%, #d32f2f 100%)',
                                                        borderRadius: '10px',
                                                        padding: '15px',
                                                        boxShadow: '0 4px 8px rgba(0,0,0,0.2)',
                                                        color: 'white'
                                                    }}>
                                                        <div style={{fontSize: '2.5rem', fontWeight: 'bold'}}>
                                                            {(resultados.sinAislador.energiaMecanica / 1000).toFixed(2)} kJ
                                                        </div>
                                                        <div style={{fontSize: '0.85rem', marginTop: '5px', opacity: 0.9}}>
                                                            Alta energ√≠a sin disipar
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>

                                            {/* Con aislador */}
                                            <div style={{
                                                background: 'linear-gradient(135deg, #e8f5e9 0%, #c8e6c9 100%)',
                                                padding: '25px',
                                                borderRadius: '15px',
                                                border: '3px solid #4CAF50'
                                            }}>
                                                <h4 style={{textAlign: 'center', color: '#2e7d32', marginBottom: '20px'}}>
                                                    üõ°Ô∏è Con Aislador {tipoAislador}
                                                </h4>
                                                
                                                <div style={{marginBottom: '20px'}}>
                                                    <div style={{fontSize: '0.9rem', marginBottom: '8px', fontWeight: 'bold'}}>
                                                        Energ√≠a Cin√©tica (Ek = ¬Ωmv¬≤)
                                                    </div>
                                                    <div style={{
                                                        background: '#fff',
                                                        borderRadius: '10px',
                                                        padding: '15px',
                                                        boxShadow: '0 4px 8px rgba(0,0,0,0.1)'
                                                    }}>
                                                        <div style={{fontSize: '2rem', fontWeight: 'bold', color: '#4CAF50'}}>
                                                            {(resultados.conAislador.energiaCinetica / 1000).toFixed(2)} kJ
                                                        </div>
                                                        <div style={{fontSize: '0.85rem', color: '#666', marginTop: '5px'}}>
                                                            Velocidad m√°x: {resultados.conAislador.velocidad.toFixed(3)} m/s
                                                        </div>
                                                        <div style={{
                                                            marginTop: '8px',
                                                            padding: '5px 10px',
                                                            background: '#4CAF50',
                                                            color: 'white',
                                                            borderRadius: '5px',
                                                            fontSize: '0.85rem',
                                                            textAlign: 'center'
                                                        }}>
                                                            ‚Üì {((1 - resultados.conAislador.energiaCinetica / resultados.sinAislador.energiaCinetica) * 100).toFixed(1)}% reducci√≥n
                                                        </div>
                                                    </div>
                                                </div>

                                                <div style={{marginBottom: '20px'}}>
                                                    <div style={{fontSize: '0.9rem', marginBottom: '8px', fontWeight: 'bold'}}>
                                                        Energ√≠a Potencial El√°stica (Es = ¬Ωku¬≤)
                                                    </div>
                                                    <div style={{
                                                        background: '#fff',
                                                        borderRadius: '10px',
                                                        padding: '15px',
                                                        boxShadow: '0 4px 8px rgba(0,0,0,0.1)'
                                                    }}>
                                                        <div style={{fontSize: '2rem', fontWeight: 'bold', color: '#66BB6A'}}>
                                                            {(resultados.conAislador.energiaPotencial / 1000).toFixed(2)} kJ
                                                        </div>
                                                        <div style={{fontSize: '0.85rem', color: '#666', marginTop: '5px'}}>
                                                            Desplazamiento: {(resultados.conAislador.desplazamiento * 100).toFixed(2)} cm
                                                        </div>
                                                        <div style={{
                                                            marginTop: '8px',
                                                            padding: '5px 10px',
                                                            background: '#66BB6A',
                                                            color: 'white',
                                                            borderRadius: '5px',
                                                            fontSize: '0.85rem',
                                                            textAlign: 'center'
                                                        }}>
                                                            ‚Üì {((1 - resultados.conAislador.energiaPotencial / resultados.sinAislador.energiaPotencial) * 100).toFixed(1)}% reducci√≥n
                                                        </div>
                                                    </div>
                                                </div>

                                                <div>
                                                    <div style={{fontSize: '0.9rem', marginBottom: '8px', fontWeight: 'bold'}}>
                                                        Energ√≠a Mec√°nica Total (Em = Ek + Es)
                                                    </div>
                                                    <div style={{
                                                        background: 'linear-gradient(135deg, #4CAF50 0%, #45a049 100%)',
                                                        borderRadius: '10px',
                                                        padding: '15px',
                                                        boxShadow: '0 4px 8px rgba(0,0,0,0.2)',
                                                        color: 'white'
                                                    }}>
                                                        <div style={{fontSize: '2.5rem', fontWeight: 'bold'}}>
                                                            {(resultados.conAislador.energiaMecanica / 1000).toFixed(2)} kJ
                                                        </div>
                                                        <div style={{fontSize: '0.85rem', marginTop: '5px', opacity: 0.9}}>
                                                            Energ√≠a controlada y disipada
                                                        </div>
                                                        <div style={{
                                                            marginTop: '10px',
                                                            padding: '8px',
                                                            background: 'rgba(255,255,255,0.3)',
                                                            borderRadius: '5px',
                                                            fontSize: '0.9rem',
                                                            textAlign: 'center',
                                                            fontWeight: 'bold'
                                                        }}>
                                                            ‚úì {((1 - resultados.conAislador.energiaMecanica / resultados.sinAislador.energiaMecanica) * 100).toFixed(1)}% reducci√≥n total
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        {/* Gr√°fico de barras comparativo */}
                                        <div style={{
                                            background: 'white',
                                            padding: '25px',
                                            borderRadius: '15px',
                                            boxShadow: '0 4px 8px rgba(0,0,0,0.1)'
                                        }}>
                                            <h4 style={{marginBottom: '20px', textAlign: 'center'}}>
                                                üìä Comparaci√≥n Energ√©tica Visual
                                            </h4>
                                            
                                            {['energiaCinetica', 'energiaPotencial', 'energiaMecanica'].map((tipo, idx) => {
                                                const labels = {
                                                    energiaCinetica: 'Energ√≠a Cin√©tica',
                                                    energiaPotencial: 'Energ√≠a Potencial',
                                                    energiaMecanica: 'Energ√≠a Mec√°nica Total'
                                                };
                                                const sin = resultados.sinAislador[tipo] / 1000;
                                                const con = resultados.conAislador[tipo] / 1000;
                                                const maxVal = sin;
                                                
                                                return (
                                                    <div key={idx} style={{marginBottom: '25px'}}>
                                                        <div style={{fontWeight: 'bold', marginBottom: '10px', color: '#2c3e50'}}>
                                                            {labels[tipo]}
                                                        </div>
                                                        <div style={{display: 'flex', gap: '10px', alignItems: 'center'}}>
                                                            <div style={{width: '120px', fontSize: '0.85rem', color: '#666'}}>
                                                                Sin Aislador:
                                                            </div>
                                                            <div style={{flex: 1, position: 'relative'}}>
                                                                <div style={{
                                                                    width: '100%',
                                                                    height: '40px',
                                                                    background: 'linear-gradient(90deg, #f44336 0%, #d32f2f 100%)',
                                                                    borderRadius: '5px',
                                                                    display: 'flex',
                                                                    alignItems: 'center',
                                                                    justifyContent: 'center',
                                                                    color: 'white',
                                                                    fontWeight: 'bold'
                                                                }}>
                                                                    {sin.toFixed(2)} kJ
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div style={{display: 'flex', gap: '10px', alignItems: 'center', marginTop: '10px'}}>
                                                            <div style={{width: '120px', fontSize: '0.85rem', color: '#666'}}>
                                                                Con Aislador:
                                                            </div>
                                                            <div style={{flex: 1, position: 'relative'}}>
                                                                <div style={{
                                                                    width: `${(con / maxVal * 100).toFixed(1)}%`,
                                                                    height: '40px',
                                                                    background: 'linear-gradient(90deg, #4CAF50 0%, #45a049 100%)',
                                                                    borderRadius: '5px',
                                                                    display: 'flex',
                                                                    alignItems: 'center',
                                                                    justifyContent: 'center',
                                                                    color: 'white',
                                                                    fontWeight: 'bold',
                                                                    minWidth: '80px'
                                                                }}>
                                                                    {con.toFixed(2)} kJ
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                );
                                            })}
                                        </div>

                                        {/* Informaci√≥n sobre disipaci√≥n de energ√≠a */}
                                        <div className="info-box" style={{marginTop: '30px'}}>
                                            <h5>üí° ¬øC√≥mo Disipa Energ√≠a el Aislador {tipoAislador}?</h5>
                                            <p style={{marginTop: '10px'}}>
                                                {tipoAislador === 'LRB' && 
                                                    'El n√∫cleo de plomo en los LRB se deforma pl√°sticamente durante el sismo, convirtiendo la energ√≠a mec√°nica en calor. Este proceso de hist√©resis proporciona un amortiguamiento del 25-30%, reduciendo significativamente la energ√≠a transmitida a la estructura.'
                                                }
                                                {tipoAislador === 'HDRB' && 
                                                    'El caucho de alto amortiguamiento contiene aditivos especiales (carb√≥n, aceites, resinas) que aumentan la disipaci√≥n de energ√≠a por fricci√≥n interna molecular. Proporciona un 10-20% de amortiguamiento efectivo, transformando la energ√≠a s√≠smica en calor.'
                                                }
                                                {tipoAislador === 'FPS' && 
                                                    'El sistema de p√©ndulo friccional disipa energ√≠a mediante fricci√≥n controlada en la superficie deslizante. La combinaci√≥n del movimiento pendular y la fricci√≥n proporciona un 15-25% de amortiguamiento, convirtiendo eficientemente la energ√≠a s√≠smica en calor.'
                                                }
                                            </p>
                                            <div style={{
                                                marginTop: '15px',
                                                padding: '15px',
                                                background: 'rgba(76, 175, 80, 0.1)',
                                                borderRadius: '10px',
                                                borderLeft: '4px solid #4CAF50'
                                            }}>
                                                <strong>Energ√≠a Disipada por el Aislador:</strong>{' '}
                                                {((resultados.sinAislador.energiaMecanica - resultados.conAislador.energiaMecanica) / 1000).toFixed(2)} kJ
                                                <br/>
                                                <strong>Porcentaje de Disipaci√≥n:</strong>{' '}
                                                {((1 - resultados.conAislador.energiaMecanica / resultados.sinAislador.energiaMecanica) * 100).toFixed(1)}%
                                                <br/>
                                                <strong>Amortiguamiento Efectivo:</strong>{' '}
                                                {(resultados.conAislador.amortiguamientoEfectivo * 100).toFixed(1)}%
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            ) : (
                                <div style={{textAlign: 'center', padding: '60px', color: '#999'}}>
                                    <h3>‚ö†Ô∏è No hay datos energ√©ticos disponibles</h3>
                                    <p>Ejecute la simulaci√≥n para ver el an√°lisis energ√©tico detallado</p>
                                    <button 
                                        className="btn-simulate" 
                                        onClick={() => setActiveTab('configuracion')}
                                        style={{marginTop: '20px'}}
                                    >
                                        Ir a Configuraci√≥n
                                    </button>
                                </div>
                            )}
                        </div>

                        {/* Panel de Gr√°ficas */}
                        <div className={`panel ${activeTab === 'graficas' ? 'active' : ''}`}>
                            {resultados ? (
                                <div className="charts-grid">
                                    <div className="control-section">
                                        <h3>üìâ Desplazamiento en Tiempo Real</h3>
                                        <p style={{marginBottom: '15px', color: '#666'}}>
                                            <strong>Observaci√≥n:</strong> El edificio con aislador s√≠smico {tipoAislador} (l√≠nea verde) presenta oscilaciones 
                                            significativamente menores y m√°s controladas que el edificio de base fija (l√≠nea roja), demostrando 
                                            la efectividad del sistema de aislamiento.
                                        </p>
                                        <div className="chart-container">
                                            <canvas ref={chartDesplazamientoRef}></canvas>
                                        </div>
                                    </div>

                                    <div className="control-section">
                                        <h3>‚ö° Aceleraci√≥n en Tiempo Real</h3>
                                        <p style={{marginBottom: '15px', color: '#666'}}>
                                            <strong>Protecci√≥n s√≠smica:</strong> El aislador reduce las aceleraciones transmitidas a la superestructura, 
                                            protegiendo tanto los elementos estructurales como el contenido del edificio (equipos, mobiliario, personas).
                                        </p>
                                        <div className="chart-container">
                                            <canvas ref={chartAceleracionRef}></canvas>
                                        </div>
                                    </div>

                                    <div className="control-section">
                                        <h3>üîã Energ√≠a Mec√°nica en Tiempo Real</h3>
                                        <p style={{marginBottom: '15px', color: '#666'}}>
                                            <strong>Disipaci√≥n de energ√≠a:</strong> La energ√≠a s√≠smica es disipada por el aislador mediante 
                                            {tipoAislador === 'LRB' && ' deformaci√≥n pl√°stica del n√∫cleo de plomo'}
                                            {tipoAislador === 'HDRB' && ' las propiedades del caucho de alto amortiguamiento'}
                                            {tipoAislador === 'FPS' && ' fricci√≥n controlada en la superficie deslizante'}, 
                                            reduciendo la energ√≠a que llega a la estructura.
                                        </p>
                                        <div className="chart-container">
                                            <canvas ref={chartEnergiaRef}></canvas>
                                        </div>
                                    </div>

                                    {isSimulating && (
                                        <div style={{
                                            textAlign: 'center',
                                            padding: '30px',
                                            background: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)',
                                            color: 'white',
                                            borderRadius: '15px',
                                            fontSize: '1.2rem',
                                            fontWeight: 'bold'
                                        }}>
                                            ‚ö° Simulaci√≥n de Evento S√≠smico en Progreso... üåä
                                        </div>
                                    )}
                                </div>
                            ) : (
                                <div style={{textAlign: 'center', padding: '60px', color: '#999'}}>
                                    <h3>‚ö†Ô∏è No hay gr√°ficas disponibles</h3>
                                    <p>Configure los par√°metros del sistema y ejecute la simulaci√≥n para ver las gr√°ficas din√°micas</p>
                                    <button 
                                        className="btn-simulate" 
                                        onClick={() => setActiveTab('configuracion')}
                                        style={{marginTop: '20px'}}
                                    >
                                        Ir a Configuraci√≥n
                                    </button>
                                </div>
                            )}
                        </div>

                        {/* Panel de Resultados */}
                        <div className={`panel ${activeTab === 'resultados' ? 'active' : ''}`}>
                            {resultados ? (
                                <>
                                    <div className="control-section">
                                        <h3>üìà Par√°metros del Sismo</h3>
                                        <div className="metrics-grid">
                                            <div className="metric-card">
                                                <div className="metric-label">PGA</div>
                                                <div className="metric-value">{resultados.metricas.pga.toFixed(3)}</div>
                                                <div className="metric-unit">m/s¬≤</div>
                                            </div>
                                            <div className="metric-card">
                                                <div className="metric-label">Frecuencia del Sitio</div>
                                                <div className="metric-value">{resultados.metricas.frecuenciaSitio.toFixed(2)}</div>
                                                <div className="metric-unit">Hz</div>
                                            </div>
                                        </div>
                                    </div>

                                    {tieneAislador && (
                                        <div className="comparison-section">
                                            <h4>üìä Efectividad del Sistema de Aislamiento {tipoAislador}</h4>
                                            <div className="comparison-bars">
                                                <div className="comparison-item">
                                                    <div className="comparison-label">Cortante Basal</div>
                                                    <div className="bars-container">
                                                        <div 
                                                            className="bar without" 
                                                            style={{width: '100%'}}
                                                        >
                                                            Sin: {(resultados.sinAislador.cortanteBasal/1000).toFixed(0)} kN
                                                        </div>
                                                        <div 
                                                            className="bar with" 
                                                            style={{
                                                                width: `${(resultados.conAislador.cortanteBasal / resultados.sinAislador.cortanteBasal * 100).toFixed(0)}%`
                                                            }}
                                                        >
                                                            Con: {(resultados.conAislador.cortanteBasal/1000).toFixed(0)} kN
                                                        </div>
                                                    </div>
                                                    <div style={{color: '#4CAF50', fontWeight: 'bold', marginTop: '5px'}}>
                                                        ‚úì Reducci√≥n: {resultados.reduccion.cortante.toFixed(1)}%
                                                    </div>
                                                </div>

                                                <div className="comparison-item">
                                                    <div className="comparison-label">Aceleraci√≥n M√°xima</div>
                                                    <div className="bars-container">
                                                        <div 
                                                            className="bar without" 
                                                            style={{width: '100%'}}
                                                        >
                                                            Sin: {resultados.sinAislador.aceleracion.toFixed(2)} m/s¬≤
                                                        </div>
                                                        <div 
                                                            className="bar with" 
                                                            style={{
                                                                width: `${(resultados.conAislador.aceleracion / resultados.sinAislador.aceleracion * 100).toFixed(0)}%`
                                                            }}
                                                        >
                                                            Con: {resultados.conAislador.aceleracion.toFixed(2)} m/s¬≤
                                                        </div>
                                                    </div>
                                                    <div style={{color: '#4CAF50', fontWeight: 'bold', marginTop: '5px'}}>
                                                        ‚úì Reducci√≥n: {resultados.reduccion.aceleracion.toFixed(1)}%
                                                    </div>
                                                </div>

                                                <div className="comparison-item">
                                                    <div className="comparison-label">Energ√≠a Mec√°nica</div>
                                                    <div className="bars-container">
                                                        <div 
                                                            className="bar without" 
                                                            style={{width: '100%'}}
                                                        >
                                                            Sin: {(resultados.sinAislador.energiaMecanica/1000).toFixed(0)} kJ
                                                        </div>
                                                        <div 
                                                            className="bar with" 
                                                            style={{
                                                                width: `${(resultados.conAislador.energiaMecanica / resultados.sinAislador.energiaMecanica * 100).toFixed(0)}%`
                                                            }}
                                                        >
                                                            Con: {(resultados.conAislador.energiaMecanica/1000).toFixed(0)} kJ
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            
                                            <div className="info-box" style={{marginTop: '20px'}}>
                                                <h5>Caracter√≠sticas del Sistema Aislado</h5>
                                                <p><strong>Periodo Aislado (Tiso):</strong> {resultados.conAislador.periodoAislado.toFixed(3)} s</p>
                                                <p><strong>Amortiguamiento Efectivo (Œæ_eff):</strong> {(resultados.conAislador.amortiguamientoEfectivo * 100).toFixed(1)}%</p>
                                                <p><strong>Desplazamiento del Aislador:</strong> {(resultados.conAislador.desplazamiento * 100).toFixed(2)} cm</p>
                                                <p style={{marginTop: '10px', fontSize: '0.9rem'}}>
                                                    El periodo del sistema aislado es significativamente mayor que el de base fija, 
                                                    lo que aleja a la estructura del rango de frecuencias dominantes del sismo.
                                                </p>
                                            </div>
                                        </div>
                                    )}
                                </>
                            ) : (
                                <div style={{textAlign: 'center', padding: '60px', color: '#999'}}>
                                    <h3>‚ö†Ô∏è No hay resultados disponibles</h3>
                                    <p>Ejecute la simulaci√≥n para ver los resultados</p>
                                </div>
                            )}
                        </div>

                        {/* Panel de Teor√≠a */}
                        <div className={`panel ${activeTab === 'teoria' ? 'active' : ''}`}>
                            <div className="control-section">
                                <h3>üìö Fundamentos del Aislamiento S√≠smico</h3>
                                <div className="info-box">
                                    <h5>¬øQu√© es el Aislamiento S√≠smico?</h5>
                                    <p>
                                        El aislamiento s√≠smico es una t√©cnica que busca <strong>desacoplar la estructura del movimiento del suelo</strong> 
                                        durante un sismo, mediante dispositivos especiales ubicados entre la cimentaci√≥n y la superestructura.
                                    </p>
                                    <p style={{marginTop: '10px'}}>
                                        <strong>Principio fundamental:</strong> Aumentar el periodo natural de vibraci√≥n de la estructura 
                                        y proporcionar amortiguamiento adicional, reduciendo as√≠ las fuerzas s√≠smicas transmitidas.
                                    </p>
                                </div>

                                <div className="info-box">
                                    <h5>Tipos de Aisladores S√≠smicos</h5>
                                    
                                    <p style={{marginTop: '15px'}}><strong>1. LRB (Lead Rubber Bearing)</strong></p>
                                    <p>
                                        ‚Ä¢ Aislador elastom√©rico con n√∫cleo de plomo<br/>
                                        ‚Ä¢ El plomo disipa energ√≠a por deformaci√≥n pl√°stica<br/>
                                        ‚Ä¢ Amortiguamiento: 25-30%<br/>
                                        ‚Ä¢ Muy efectivo para sismos de alta intensidad
                                    </p>

                                    <p style={{marginTop: '15px'}}><strong>2. HDRB (High Damping Rubber Bearing)</strong></p>
                                    <p>
                                        ‚Ä¢ Caucho especial con aditivos (carb√≥n, aceites, resinas)<br/>
                                        ‚Ä¢ Amortiguamiento: 10-20%<br/>
                                        ‚Ä¢ Ahorro de 20-50% comparado con SREI<br/>
                                        ‚Ä¢ Ampliamente usado en edificios de baja altura
                                    </p>

                                    <p style={{marginTop: '15px'}}><strong>3. FPS (Friction Pendulum System)</strong></p>
                                    <p>
                                        ‚Ä¢ Sistema de p√©ndulo friccional<br/>
                                        ‚Ä¢ Deslizamiento sobre superficie c√≥ncava<br/>
                                        ‚Ä¢ Amortiguamiento por fricci√≥n controlada<br/>
                                        ‚Ä¢ Periodo independiente de la masa
                                    </p>
                                </div>

                                <div className="info-box">
                                    <h5>Efecto del Tipo de Suelo</h5>
                                    <p>
                                        <strong>Clasificaci√≥n NSR-10 Colombia:</strong><br/>
                                        ‚Ä¢ <strong>Tipo A (Roca):</strong> Vs &gt; 750 m/s, Factor 1.0 - Suelo m√°s favorable<br/>
                                        ‚Ä¢ <strong>Tipo B (Roca Suave):</strong> 360-750 m/s, Factor 1.2<br/>
                                        ‚Ä¢ <strong>Tipo C (Suelo Denso):</strong> 180-360 m/s, Factor 1.5<br/>
                                        ‚Ä¢ <strong>Tipo D (Suelo R√≠gido):</strong> ~180 m/s, Factor 1.8<br/>
                                        ‚Ä¢ <strong>Tipo E (Suelo Blando):</strong> &lt; 180 m/s, Factor 2.4 - Mayor amplificaci√≥n
                                    </p>
                                    <p style={{marginTop: '10px'}}>
                                        Los suelos blandos amplifican las ondas s√≠smicas significativamente m√°s que los suelos rocosos, 
                                        aumentando el riesgo s√≠smico y haciendo m√°s necesario el uso de sistemas de aislamiento.
                                    </p>
                                </div>

                                <div className="info-box">
                                    <h5>Ventajas del Aislamiento S√≠smico</h5>
                                    <p>
                                        ‚úì <strong>Reducci√≥n de fuerzas s√≠smicas:</strong> 60-80% en cortante basal<br/>
                                        ‚úì <strong>Protecci√≥n de contenidos:</strong> Menor aceleraci√≥n = menos da√±o a equipos y mobiliario<br/>
                                        ‚úì <strong>Operacionalidad post-sismo:</strong> El edificio puede seguir funcionando<br/>
                                        ‚úì <strong>Reemplazable:</strong> Los aisladores pueden cambiarse sin afectar la estructura<br/>
                                        ‚úì <strong>Protecci√≥n de vidas:</strong> Menor riesgo para los ocupantes
                                    </p>
                                </div>

                                <div className="info-box">
                                    <h5>An√°lisis Energ√©tico</h5>
                                    <p>
                                        <strong>Energ√≠a Cin√©tica (Ek):</strong> Ek = ¬Ωmv¬≤ - Energ√≠a del movimiento de la estructura<br/>
                                        <strong>Energ√≠a Potencial (Es):</strong> Es = ¬Ωku¬≤ - Energ√≠a almacenada por deformaci√≥n<br/>
                                        <strong>Energ√≠a Mec√°nica (Em):</strong> Em = Ek + Es - Energ√≠a total del sistema
                                    </p>
                                    <p style={{marginTop: '10px'}}>
                                        El aislador s√≠smico disipa gran parte de la energ√≠a s√≠smica mediante mecanismos de amortiguamiento 
                                        (hist√©resis en LRB, fricci√≥n interna en HDRB, fricci√≥n deslizante en FPS), transformando la energ√≠a 
                                        mec√°nica en calor y reduciendo la energ√≠a transmitida a la superestructura.
                                    </p>
                                </div>

                                <div className="info-box">
                                    <h5>Aplicaciones en Colombia</h5>
                                    <p>
                                        <strong>Estado actual:</strong> Colombia, siendo un pa√≠s de alta actividad s√≠smica (85% de la poblaci√≥n 
                                        en zona de amenaza), ha implementado aisladores en:
                                    </p>
                                    <p style={{marginTop: '10px'}}>
                                        ‚Ä¢ <strong>Puentes:</strong> Viaducto Portachuelo (Zipaquir√°), Puente Cra. 44 (Cali)<br/>
                                        ‚Ä¢ <strong>Edificios:</strong> Solo 3 edificios aislados para 2016 (uso especial)<br/>
                                        ‚Ä¢ <strong>Desaf√≠o:</strong> Alto costo de importaci√≥n - no hay fabricaci√≥n local
                                    </p>
                                </div>

                                <div className="info-box">
                                    <h5>F√≥rmulas Clave</h5>
                                    <p>
                                        <strong>Periodo estructural:</strong> T = 0.1 √ó N_pisos (s)<br/>
                                        <strong>Frecuencia del sitio:</strong> f‚ÇÄ = VS / (4H) (Hz)<br/>
                                        <strong>Periodo aislado:</strong> Tiso = 2œÄ‚àö(m/k_eff) (s)<br/>
                                        <strong>Cortante basal:</strong> V = ku + cv (kN)<br/>
                                        <strong>Energ√≠a cin√©tica:</strong> Ek = ¬Ωmv¬≤ (J)<br/>
                                        <strong>Energ√≠a potencial:</strong> Es = ¬Ωku¬≤ (J)
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            );
        }

        ReactDOM.render(<SimuladorSismico />, document.getElementById('root'));
    </script>
</body>
</html>